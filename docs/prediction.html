<html><head><title>Gaussian Processes: Fitting a Gaussian Process</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="docs" /><meta name="description" content="Gaussian Processes" /><meta name="og:image" content="/gaussian-processes/img/poster.png" /><meta name="image" property="og:image" content="/gaussian-processes/img/poster.png" /><meta name="og:title" content="Gaussian Processes: Fitting a Gaussian Process" /><meta name="title" property="og:title" content="Gaussian Processes: Fitting a Gaussian Process" /><meta name="og:site_name" content="Gaussian Processes" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Gaussian Processes" /><link rel="icon" type="image/png" href="/gaussian-processes/img/favicon.png" /><meta name="twitter:title" content="Gaussian Processes: Fitting a Gaussian Process" /><meta name="twitter:image" content="/gaussian-processes/img/poster.png" /><meta name="twitter:description" content="Gaussian Processes" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/gaussian-processes/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/gaussian-processes/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/gaussian-processes/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/gaussian-processes/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/gaussian-processes/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/gaussian-processes/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/gaussian-processes/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/gaussian-processes/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/gaussian-processes/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/gaussian-processes/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/gaussian-processes/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/gaussian-processes/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/gaussian-processes/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/gaussian-processes/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/gaussian-processes/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/gaussian-processes/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/gaussian-processes/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/gaussian-processes/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/gaussian-processes/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/gaussian-processes/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/gaussian-processes/highlight/styles/solarized-dark.css" /><link rel="stylesheet" href="/gaussian-processes/css/style.css" /><link rel="stylesheet" href="/gaussian-processes/css/palette.css" /><link rel="stylesheet" href="/gaussian-processes/css/codemirror.css" /><link rel="stylesheet" href="/gaussian-processes/css/solarized-dark.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/gaussian-processes/" class="brand"><div class="brand-wrapper"><span>Gaussian Processes</span></div></a></li> <li><a href="/gaussian-processes/docs/index.html" class="">Getting Started</a></li> <li><a href="/gaussian-processes/docs/prediction.html" class="">Prediction</a></li> <li><a href="/gaussian-processes/docs/parameter_inference.html" class="">Parameter Inference</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/jonnylaw/gaussian-processes"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/jonnylaw/gaussian-processes"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('Gaussian Processes Gaussian Processes');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('Gaussian Processes Gaussian Processes');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="jonnylaw" data-github-repo="gaussian-processes"><div class="content-wrapper"><section><p>Given values of the hyper parameters of the covariance and mean functions. Then
we can determine the posterior distribution of the function (y \approx f(x))
given paired data ((x, y)) where (x) is in the domain of the function.
Typically, (x) will be a location or time and $y$ is a process we want to learn about.</p>

<p>For a continuous outcome, $y$ the likelihood and prior is Gaussian, resulting in
a posterior distribution which is also Gaussian and can be derived exactly.
Given a location with an unknown measurement, $y(x^\star)$, then the posterior
is Gaussian and can be determined analytically by calculating the mean and variance:</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align*}
\mathbb{E}(y(x^\star)) &= K(x_\star, \textbf{x})^T(K(\textbf{x}, \textbf{x}) + I_n\sigma_y)^{-1}\textbf{y} \\
\textrm{Var}(y(x^\star)) &= K(x_\star, x_\star) - K(x_\star, \textbf{x})^T(K(\textbf{x}, \textbf{x}) + I_n\sigma_y^2)^{-1}K(x_\star, \textbf{x})
\end{align*} %]]></script>

<p>Suppose that we want to determine the posterior distribution of the function
(f(x)) by observing finitely many points from the simulation in the <a href="introduction.html">GP
introduction</a>. This can be simulated by specifying the
parameters and a distance function:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">com.github.jonnylaw.gp._</span>
<span class="k">import</span> <span class="nn">com.github.jonnylaw.gp._</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">params</span> <span class="k">=</span> <span class="nc">GaussianProcess</span><span class="o">.</span><span class="nc">Parameters</span><span class="o">(</span>
     <span class="o">|</span>   <span class="nc">MeanParameters</span><span class="o">.</span><span class="n">zero</span><span class="o">,</span>
     <span class="o">|</span>   <span class="nc">Vector</span><span class="o">(</span><span class="nc">KernelParameters</span><span class="o">.</span><span class="n">se</span><span class="o">(</span><span class="mf">3.0</span><span class="o">,</span> <span class="mf">5.5</span><span class="o">))</span>
     <span class="o">|</span> <span class="o">)</span>
<span class="n">params</span><span class="k">:</span> <span class="kt">com.github.jonnylaw.gp.GaussianProcess.Parameters</span> <span class="o">=</span> <span class="nc">Parameters</span><span class="o">(</span><span class="nc">Zero</span><span class="o">,</span><span class="nc">Vector</span><span class="o">(</span><span class="nc">SquaredExp</span><span class="o">(</span><span class="mf">3.0</span><span class="o">,</span><span class="mf">5.5</span><span class="o">)))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">dist</span> <span class="k">=</span> <span class="nc">Location</span><span class="o">.</span><span class="n">euclidean</span> <span class="k">_</span>
<span class="n">dist</span><span class="k">:</span> <span class="o">(</span><span class="kt">com.github.jonnylaw.gp.Location</span><span class="o">[</span><span class="kt">Double</span><span class="o">],</span> <span class="n">com</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">jonnylaw</span><span class="o">.</span><span class="n">gp</span><span class="o">.</span><span class="nc">Location</span><span class="o">[</span><span class="kt">Double</span><span class="o">])</span> <span class="k">=&gt;</span> <span class="nc">Double</span> <span class="k">=</span> <span class="nc">$$Lambda$4761</span><span class="o">/</span><span class="mi">25405048</span><span class="k">@</span><span class="mf">7d</span><span class="n">a61b17</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">xs</span> <span class="k">=</span> <span class="nc">GaussianProcess</span><span class="o">.</span><span class="n">samplePoints</span><span class="o">(-</span><span class="mf">10.0</span><span class="o">,</span> <span class="mf">10.0</span><span class="o">,</span> <span class="mi">300</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="nc">One</span><span class="o">.</span><span class="n">apply</span><span class="o">)</span>
<span class="n">xs</span><span class="k">:</span> <span class="kt">scala.collection.immutable.Vector</span><span class="o">[</span><span class="kt">com.github.jonnylaw.gp.One</span><span class="o">[</span><span class="kt">Double</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">Vector</span><span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">9.941489530234545</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.892201998986835</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.88746451260733</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.834481496295219</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.822148646829657</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.741025915461119</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.623468283678704</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.61139323426416</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.530724488099862</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.51022639545457</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.38365284647459</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.364412325666844</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.305069593851316</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.272610837221524</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.268463376451166</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.20952626701756</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">8.916197862632348</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">8.818627066623211</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">8.74282001445482</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">8.742738837913482</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">8.736709101210312</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">8.64038980299215</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">8.585143756062145</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">8.515727768962208</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">8.506961416887137</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">8.470133308249906</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">8.44065709958703</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">8.39636764306056</span><span class="o">...</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">ys</span> <span class="k">=</span> <span class="nc">GaussianProcess</span><span class="o">.</span><span class="n">draw</span><span class="o">(</span><span class="n">xs</span><span class="o">,</span> <span class="n">dist</span><span class="o">,</span> <span class="n">params</span><span class="o">)</span>
<span class="n">ys</span><span class="k">:</span> <span class="kt">breeze.linalg.DenseVector</span><span class="o">[</span><span class="kt">Double</span><span class="o">]</span> <span class="k">=</span> <span class="nc">DenseVector</span><span class="o">(</span><span class="mf">2.470322295483582</span><span class="o">,</span> <span class="mf">2.472804862109706</span><span class="o">,</span> <span class="mf">2.502151603806125</span><span class="o">,</span> <span class="mf">2.4869363511865776</span><span class="o">,</span> <span class="mf">2.4109763208684023</span><span class="o">,</span> <span class="mf">2.4465823434037395</span><span class="o">,</span> <span class="mf">2.450106778027504</span><span class="o">,</span> <span class="mf">2.3810091146858365</span><span class="o">,</span> <span class="mf">2.358619383679186</span><span class="o">,</span> <span class="mf">2.3307337236838856</span><span class="o">,</span> <span class="mf">2.2481926756535597</span><span class="o">,</span> <span class="mf">2.2899426594890917</span><span class="o">,</span> <span class="mf">2.262765528866652</span><span class="o">,</span> <span class="mf">2.224889679049942</span><span class="o">,</span> <span class="mf">2.231318818861936</span><span class="o">,</span> <span class="mf">2.2545359091733</span><span class="o">,</span> <span class="mf">2.0559399978013215</span><span class="o">,</span> <span class="mf">2.002543071384318</span><span class="o">,</span> <span class="mf">1.982113091000039</span><span class="o">,</span> <span class="mf">1.9948351396680797</span><span class="o">,</span> <span class="mf">2.0356364423090616</span><span class="o">,</span> <span class="mf">1.9328254686569333</span><span class="o">,</span> <span class="mf">1.921432099421113</span><span class="o">,</span> <span class="mf">1.921332680817836</span><span class="o">,</span> <span class="mf">1.8864718826315472</span><span class="o">,</span> <span class="mf">1.8934541753932785</span><span class="o">,</span> <span class="mf">1.9020216697005896</span><span class="o">,</span> <span class="mf">1.8819878828706853</span><span class="o">,</span> <span class="mf">1.8804876044983512</span><span class="o">,</span> <span class="mf">1.7902785026999737</span><span class="o">,</span> <span class="mf">1.8501944549108762</span><span class="o">,</span> <span class="mf">1.7655484094310925</span><span class="o">,</span> <span class="mf">1.8462419182352112</span><span class="o">,</span> <span class="mf">1.7791935715341192</span><span class="o">,</span> <span class="mf">1.7514208199939156</span><span class="o">,</span> <span class="mf">1.7430336830561342</span><span class="o">,</span> <span class="mf">1.707672018587</span><span class="o">...</span>
</code></pre></div></div>

<p>Then observing only every 15th point:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">observed</span> <span class="k">=</span> <span class="nc">GaussianProcess</span><span class="o">.</span><span class="n">vecToData</span><span class="o">(</span><span class="n">ys</span><span class="o">,</span> <span class="n">xs</span><span class="o">).</span>
     <span class="o">|</span>     <span class="n">zipWithIndex</span><span class="o">.</span>
     <span class="o">|</span>     <span class="n">filter</span> <span class="o">{</span> <span class="k">case</span> <span class="o">(</span><span class="k">_</span><span class="o">,</span> <span class="n">i</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">%</span> <span class="mi">15</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">}.</span>
     <span class="o">|</span>     <span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">_1</span><span class="o">)</span>
<span class="n">observed</span><span class="k">:</span> <span class="kt">scala.collection.immutable.Vector</span><span class="o">[</span><span class="kt">com.github.jonnylaw.gp.GaussianProcess.Data</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Vector</span><span class="o">(</span><span class="nc">Data</span><span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">9.268463376451166</span><span class="o">),</span><span class="mf">2.231318818861936</span><span class="o">),</span> <span class="nc">Data</span><span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">8.3171034203569</span><span class="o">),</span><span class="mf">1.7902785026999737</span><span class="o">),</span> <span class="nc">Data</span><span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">7.1256760197582425</span><span class="o">),</span><span class="mf">1.406813324027614</span><span class="o">),</span> <span class="nc">Data</span><span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">6.469971686164144</span><span class="o">),</span><span class="mf">1.2881927390521342</span><span class="o">),</span> <span class="nc">Data</span><span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">5.064579296232203</span><span class="o">),</span><span class="mf">1.2858816356619005</span><span class="o">),</span> <span class="nc">Data</span><span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">3.753648984098459</span><span class="o">),</span><span class="mf">1.5984588765700305</span><span class="o">),</span> <span class="nc">Data</span><span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">3.028390497928073</span><span class="o">),</span><span class="mf">1.6915533429517275</span><span class="o">),</span> <span class="nc">Data</span><span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">1.9967634340876437</span><span class="o">),</span><span class="mf">1.7935236887011288</span><span class="o">),</span> <span class="nc">Data</span><span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">0.462575885159616</span><span class="o">),</span><span class="mf">1.4279969572880766</span><span class="o">),</span> <span class="nc">Data</span><span class="o">(</span><span class="nc">One</span><span class="o">(</span><span class="mf">0.6433167126005479</span><span class="o">),</span><span class="mf">0.8349591340785188</span><span class="o">),</span> <span class="nc">Data</span><span class="o">(</span><span class="nc">One</span><span class="o">(</span><span class="mf">1.4538561383192814</span><span class="o">),</span><span class="mf">0.4057804033263337</span><span class="o">),</span> <span class="nc">Data</span><span class="o">(</span><span class="nc">One</span><span class="o">(</span><span class="mf">2.377505819773873</span><span class="o">),</span><span class="mf">0.011527162645879607</span><span class="o">),</span> <span class="nc">Data</span><span class="o">(</span><span class="nc">One</span><span class="o">(</span><span class="mf">3.5027275093878316</span><span class="o">),-</span><span class="mf">0.42695009098197645</span><span class="o">),</span> <span class="nc">Data</span><span class="o">(</span><span class="nc">One</span><span class="o">(</span><span class="mf">4.43864487368</span><span class="o">...</span>
</code></pre></div></div>

<p>In order to determine the posterior distribution of the function, we specify a
list of test-points which are in the same domain as the function and calculate
the posterior mean and variance given the observed data:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">implicit</span> <span class="k">val</span> <span class="n">integralD</span> <span class="k">=</span> <span class="n">scala</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="nc">Numeric</span><span class="o">.</span><span class="nc">DoubleAsIfIntegral</span>
<span class="n">integralD</span><span class="k">:</span> <span class="kt">math.Numeric.DoubleAsIfIntegral.</span><span class="k">type</span> <span class="o">=</span> <span class="n">scala</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="nc">Numeric$DoubleAsIfIntegral</span><span class="n">$</span><span class="k">@</span><span class="mf">57f</span><span class="n">ae983</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">testPoints</span> <span class="k">=</span> <span class="nc">Vector</span><span class="o">.</span><span class="n">range</span><span class="o">(-</span><span class="mf">10.0</span><span class="o">,</span> <span class="mf">10.0</span><span class="o">,</span> <span class="mf">0.01</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="nc">One</span><span class="o">(</span><span class="k">_</span><span class="o">))</span>
<span class="n">testPoints</span><span class="k">:</span> <span class="kt">scala.collection.immutable.Vector</span><span class="o">[</span><span class="kt">com.github.jonnylaw.gp.One</span><span class="o">[</span><span class="kt">Double</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">Vector</span><span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">10.0</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.99</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.98</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.97</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.96</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.950000000000001</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.940000000000001</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.930000000000001</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.920000000000002</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.910000000000002</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.900000000000002</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.890000000000002</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.880000000000003</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.870000000000003</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.860000000000003</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.850000000000003</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.840000000000003</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.830000000000004</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.820000000000004</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.810000000000004</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.800000000000004</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.790000000000004</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.780000000000005</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.770000000000005</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.760000000000005</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.750000000000005</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.740000000000006</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.730000000000006</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.720000000000006</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.7100000000000</span><span class="o">...</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="c1">// draw from the GP posterior at values of testPoints
</span>     <span class="o">|</span> <span class="k">val</span> <span class="n">fitted</span> <span class="k">=</span> <span class="nc">Predict</span><span class="o">.</span><span class="n">fit</span><span class="o">(</span><span class="n">testPoints</span> <span class="o">++</span> <span class="n">observed</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">x</span><span class="o">),</span> <span class="n">observed</span><span class="o">,</span> <span class="n">dist</span><span class="o">,</span> <span class="n">params</span><span class="o">)</span>
<span class="n">fitted</span><span class="k">:</span> <span class="kt">Vector</span><span class="o">[(</span><span class="kt">com.github.jonnylaw.gp.Location</span><span class="o">[</span><span class="kt">Double</span><span class="o">]</span>, <span class="kt">breeze.stats.distributions.Gaussian</span><span class="o">)]</span> <span class="k">=</span> <span class="nc">Vector</span><span class="o">((</span><span class="nc">One</span><span class="o">(-</span><span class="mf">10.0</span><span class="o">),</span><span class="nc">Gaussian</span><span class="o">(</span><span class="mf">2.6265023194241595</span><span class="o">,</span> <span class="mf">0.008800438024368596</span><span class="o">)),</span> <span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">9.99</span><span class="o">),</span><span class="nc">Gaussian</span><span class="o">(</span><span class="mf">2.6208193655164806</span><span class="o">,</span> <span class="mf">0.008598616344788002</span><span class="o">)),</span> <span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">9.98</span><span class="o">),</span><span class="nc">Gaussian</span><span class="o">(</span><span class="mf">2.615143160549623</span><span class="o">,</span> <span class="mf">0.008399945081009408</span><span class="o">)),</span> <span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">9.97</span><span class="o">),</span><span class="nc">Gaussian</span><span class="o">(</span><span class="mf">2.609473742074285</span><span class="o">,</span> <span class="mf">0.00820439651602306</span><span class="o">)),</span> <span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">9.96</span><span class="o">),</span><span class="nc">Gaussian</span><span class="o">(</span><span class="mf">2.603811147585371</span><span class="o">,</span> <span class="mf">0.008011943090634294</span><span class="o">)),</span> <span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">9.950000000000001</span><span class="o">),</span><span class="nc">Gaussian</span><span class="o">(</span><span class="mf">2.5981554143834074</span><span class="o">,</span> <span class="mf">0.007822557411543881</span><span class="o">)),</span> <span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">9.940000000000001</span><span class="o">),</span><span class="nc">Gaussian</span><span class="o">(</span><span class="mf">2.592506579735958</span><span class="o">,</span> <span class="mf">0.007636212257528998</span><span class="o">)),</span> <span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">9.930000000000001</span><span class="o">),</span><span class="nc">Gaussian</span><span class="o">(</span><span class="mf">2.58686468072453</span><span class="o">,</span> <span class="mf">0.007452880583915524</span><span class="o">)),</span> <span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">9.920000000000002</span><span class="o">),</span><span class="nc">Gaussian</span><span class="o">(</span><span class="mf">2.5812297543613525</span><span class="o">,</span> <span class="mf">0.007272535530356579</span><span class="o">)),</span> <span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">9.910000000000002</span><span class="o">),</span><span class="nc">Gaussian</span><span class="o">(</span><span class="mf">2.5</span><span class="o">...</span>
</code></pre></div></div>

<p>This calculates the mean and covariance at each of the test points. This can be
used to determine posterior probability intervals for the function which can then be plotted:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">com.cibo.evilplot.plot.aesthetics.DefaultTheme._</span>
<span class="k">import</span> <span class="nn">com.cibo.evilplot.plot.aesthetics.DefaultTheme._</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="nc">Plot</span><span class="o">.</span><span class="n">gpPlot</span><span class="o">(</span><span class="n">fitted</span><span class="o">)</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">com.cibo.evilplot.plot.Plot</span> <span class="o">=</span> <span class="nc">Plot</span><span class="o">(</span><span class="nc">Bounds</span><span class="o">(-</span><span class="mf">10.0</span><span class="o">,</span><span class="mf">10.0</span><span class="o">),</span><span class="nc">Bounds</span><span class="o">(-</span><span class="mf">1.0</span><span class="o">,</span><span class="mf">3.0</span><span class="o">),</span><span class="nc">OverlayPlotRenderer</span><span class="o">(</span><span class="nc">ArrayBuffer</span><span class="o">(</span><span class="nc">Plot</span><span class="o">(</span><span class="nc">Bounds</span><span class="o">(-</span><span class="mf">10.0</span><span class="o">,</span><span class="mf">10.0</span><span class="o">),</span><span class="nc">Bounds</span><span class="o">(-</span><span class="mf">1.0</span><span class="o">,</span><span class="mf">3.0</span><span class="o">),</span><span class="nc">LinePlotRenderer</span><span class="o">(</span><span class="nc">Vector</span><span class="o">(</span><span class="nc">Point</span><span class="o">(-</span><span class="mf">10.0</span><span class="o">,</span><span class="mf">2.640977751827304</span><span class="o">),</span> <span class="nc">Point</span><span class="o">(-</span><span class="mf">9.99</span><span class="o">,</span><span class="mf">2.6349628307979693</span><span class="o">),</span> <span class="nc">Point</span><span class="o">(-</span><span class="mf">9.98</span><span class="o">,</span><span class="mf">2.6289598406823145</span><span class="o">),</span> <span class="nc">Point</span><span class="o">(-</span><span class="mf">9.97</span><span class="o">,</span><span class="mf">2.6229687734406135</span><span class="o">),</span> <span class="nc">Point</span><span class="o">(-</span><span class="mf">9.96</span><span class="o">,</span><span class="mf">2.6169896212369297</span><span class="o">),</span> <span class="nc">Point</span><span class="o">(-</span><span class="mf">9.950000000000001</span><span class="o">,</span><span class="mf">2.6110223763138216</span><span class="o">),</span> <span class="nc">Point</span><span class="o">(-</span><span class="mf">9.940000000000001</span><span class="o">,</span><span class="mf">2.605067031163926</span><span class="o">),</span> <span class="nc">Point</span><span class="o">(-</span><span class="mf">9.930000000000001</span><span class="o">,</span><span class="mf">2.5991235783842197</span><span class="o">),</span> <span class="nc">Point</span><span class="o">(-</span><span class="mf">9.920000000000002</span><span class="o">,</span><span class="mf">2.593192010805593</span><span class="o">),</span> <span class="nc">Point</span><span class="o">(-</span><span class="mf">9.910000000000002</span><span class="o">,</span><span class="mf">2.587272321468688</span><span class="o">),</span> <span class="nc">Point</span><span class="o">(-</span><span class="mf">9.900000000000002</span><span class="o">,</span><span class="mf">2.581364503608263</span><span class="o">),</span> <span class="nc">Point</span><span class="o">(-</span><span class="mf">9.890000000000002</span><span class="o">,</span><span class="mf">2.575468550699628</span><span class="o">),</span> <span class="nc">Point</span><span class="o">(-</span><span class="mf">9.880000000000003</span><span class="o">,</span><span class="mf">2.569584456508014</span><span class="o">),</span> <span class="nc">Point</span><span class="o">(-</span><span class="mf">9.870000000000003</span><span class="o">,</span><span class="mf">2.56371221498816</span><span class="o">),</span> <span class="nc">Point</span><span class="o">(-</span><span class="mf">9.860000000000003</span><span class="o">,</span><span class="mf">2.</span><span class="o">...</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">com</span><span class="o">.</span><span class="n">cibo</span><span class="o">.</span><span class="n">evilplot</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="nc">Overlay</span><span class="o">(</span><span class="nc">Plot</span><span class="o">.</span><span class="n">scatterPlot</span><span class="o">(</span><span class="n">observed</span><span class="o">)).</span>
     <span class="o">|</span>   <span class="n">render</span><span class="o">().</span>
     <span class="o">|</span>   <span class="n">write</span><span class="o">(</span><span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="nc">File</span><span class="o">(</span><span class="s">"docs/src/main/resources/figures/fitted_gp.png"</span><span class="o">))</span>
</code></pre></div></div>

<p><img src="../img/fitted_gp.png" alt="Posterior distribution of Gaussian Process" width="600" /></p>

</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/gaussian-processes/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlighting();
              </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>((window.gitter = {}).chat = {}).options = {
room: 'jonnylaw/gaussian-processes'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/gaussian-processes/js/main.js"></script></body></html>