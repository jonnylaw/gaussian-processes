<html><head><title>Gaussian Processes: Introduction to the Gaussian Process</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="docs" /><meta name="description" content="Gaussian Processes" /><meta name="og:image" content="/gaussian-processes/img/poster.png" /><meta name="image" property="og:image" content="/gaussian-processes/img/poster.png" /><meta name="og:title" content="Gaussian Processes: Introduction to the Gaussian Process" /><meta name="title" property="og:title" content="Gaussian Processes: Introduction to the Gaussian Process" /><meta name="og:site_name" content="Gaussian Processes" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Gaussian Processes" /><link rel="icon" type="image/png" href="/gaussian-processes/img/favicon.png" /><meta name="twitter:title" content="Gaussian Processes: Introduction to the Gaussian Process" /><meta name="twitter:image" content="/gaussian-processes/img/poster.png" /><meta name="twitter:description" content="Gaussian Processes" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/gaussian-processes/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/gaussian-processes/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/gaussian-processes/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/gaussian-processes/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/gaussian-processes/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/gaussian-processes/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/gaussian-processes/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/gaussian-processes/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/gaussian-processes/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/gaussian-processes/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/gaussian-processes/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/gaussian-processes/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/gaussian-processes/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/gaussian-processes/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/gaussian-processes/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/gaussian-processes/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/gaussian-processes/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/gaussian-processes/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/gaussian-processes/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/gaussian-processes/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/gaussian-processes/highlight/styles/solarized-dark.css" /><link rel="stylesheet" href="/gaussian-processes/css/style.css" /><link rel="stylesheet" href="/gaussian-processes/css/palette.css" /><link rel="stylesheet" href="/gaussian-processes/css/codemirror.css" /><link rel="stylesheet" href="/gaussian-processes/css/solarized-dark.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/gaussian-processes/" class="brand"><div class="brand-wrapper"><span>Gaussian Processes</span></div></a></li> <li><a href="/gaussian-processes/docs/index.html" class="">Getting Started</a></li> <li><a href="/gaussian-processes/docs/prediction.html" class="">Prediction</a></li> <li><a href="/gaussian-processes/docs/parameter_inference.html" class="">Parameter Inference</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/jonnylaw/gaussian-processes"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/jonnylaw/gaussian-processes"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li></ul></div></div></div></div><div id="content" data-github-owner="jonnylaw" data-github-repo="gaussian-processes"><div class="content-wrapper"><section><p>A Gaussian Process can be used to approximate a non-linear function <code class="highlighter-rouge">\(y = f(x)\)</code>. To get started with the Gaussian Process package, first import the library:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">com.github.jonnylaw.gp._</span>
</code></pre></div></div>

<p>Finitely many points of a Gaussian process are distributed according to a
multivariate Normal (MVN) distribution. The MVN is parameterised by a mean and
<a href="covariance_function.html">covariance function</a>. A covariance function is
determined by the distance between points and some static parameters. The
distance function can be any suitable function from a pair of locations to a
distance measurement <code class="highlighter-rouge">(Location[Double], Location[Double]) =&gt; Double</code>. Euclidean
distance is a suitable distance function when dealing with small scale spatial data:</p>

<script type="math/tex; mode=display">\textrm{d}(x, y) = \sqrt{x^2 - y^2}</script>

<p>Other suitable distance functions include Manhattan distance or Great Circle
distance for measurements on global scale.</p>

<p>In order to simulate data from a Gaussian Process, first specify a vector of locations:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">xs</span> <span class="k">=</span> <span class="nc">GaussianProcess</span><span class="o">.</span><span class="n">samplePoints</span><span class="o">(-</span><span class="mf">10.0</span><span class="o">,</span> <span class="mf">10.0</span><span class="o">,</span> <span class="mi">100</span><span class="o">).</span>
     <span class="o">|</span>   <span class="n">map</span><span class="o">(</span><span class="nc">One</span><span class="o">.</span><span class="n">apply</span><span class="o">)</span>
<span class="n">xs</span><span class="k">:</span> <span class="kt">scala.collection.immutable.Vector</span><span class="o">[</span><span class="kt">com.github.jonnylaw.gp.One</span><span class="o">[</span><span class="kt">Double</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">Vector</span><span class="o">(</span><span class="nc">One</span><span class="o">(-</span><span class="mf">9.859552146780675</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.832488280812374</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.768698045015466</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">9.442795800797992</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">8.908371260519562</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">8.639547218148369</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">8.596512364554968</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">8.481551204523905</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">8.033944278630187</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">7.8309854004202295</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">7.684292383471911</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">7.624921971461109</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">7.210476690810554</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">7.005713594412382</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">6.869650718857394</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">6.570876382304092</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">6.059245751021551</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">5.805565083562594</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">5.7235159505558375</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">5.7021098915442</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">5.649566529769858</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">5.518758081800166</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">5.314373893566979</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">5.1505070184288115</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">4.99831136861129</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">4.612459379259848</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">4.522017634102178</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">4.222217751791009</span><span class="o">),</span> <span class="nc">One</span><span class="o">(-</span><span class="mf">4.0820258</span><span class="o">...</span>
</code></pre></div></div>

<p>The function <code class="highlighter-rouge">samplePoints</code> uniformly samples a vector of 300 Doubles between -10
and 10. The sampled points are then put into a <code class="highlighter-rouge">Location</code> object <code class="highlighter-rouge">One</code>. Next a
matrix representing the pairwise distances between each point can be calculated:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">m</span> <span class="k">=</span> <span class="nc">GaussianProcess</span><span class="o">.</span><span class="n">distanceMatrix</span><span class="o">(</span><span class="n">xs</span><span class="o">,</span> <span class="nc">Location</span><span class="o">.</span><span class="n">euclidean</span><span class="o">)</span>
<span class="n">m</span><span class="k">:</span> <span class="kt">breeze.linalg.DenseMatrix</span><span class="o">[</span><span class="kt">Double</span><span class="o">]</span> <span class="k">=</span>
<span class="mf">0.0</span>                  <span class="mf">0.02706386596830157</span>  <span class="mf">0.0908541017652098</span>   <span class="o">...</span> <span class="o">(</span><span class="mi">100</span> <span class="n">total</span><span class="o">)</span>
<span class="mf">0.02706386596830157</span>  <span class="mf">0.0</span>                  <span class="mf">0.06379023579690823</span>  <span class="o">...</span>
<span class="mf">0.0908541017652098</span>   <span class="mf">0.06379023579690823</span>  <span class="mf">0.0</span>                  <span class="o">...</span>
<span class="mf">0.41675634598268374</span>  <span class="mf">0.38969248001438217</span>  <span class="mf">0.32590224421747394</span>  <span class="o">...</span>
<span class="mf">0.9511808862611133</span>   <span class="mf">0.9241170202928117</span>   <span class="mf">0.8603267844959035</span>   <span class="o">...</span>
<span class="mf">1.2200049286323065</span>   <span class="mf">1.192941062664005</span>    <span class="mf">1.1291508268670967</span>   <span class="o">...</span>
<span class="mf">1.2630397822257073</span>   <span class="mf">1.2359759162574058</span>   <span class="mf">1.1721856804604975</span>   <span class="o">...</span>
<span class="mf">1.3780009422567705</span>   <span class="mf">1.350937076288469</span>    <span class="mf">1.2871468404915607</span>   <span class="o">...</span>
<span class="mf">1.8256078681504881</span>   <span class="mf">1.7985440021821866</span>   <span class="mf">1.7347537663852783</span>   <span class="o">...</span>
<span class="mf">2.028566746360446</span>    <span class="mf">2.0015028803921444</span>   <span class="mf">1.9377126445952362</span>   <span class="o">...</span>
<span class="mf">2.1752597633087642</span>   <span class="mf">2.1481958973404627</span>   <span class="mf">2.0844056615435544</span>   <span class="o">...</span>
<span class="mf">2.2346301</span><span class="o">...</span>
</code></pre></div></div>

<p>Next a covariance function can be selected, for instance the squared exponential
covariance function:</p>

<script type="math/tex; mode=display">K(x, y) = h\exp\left\{ \frac{1}{\sigma^2}\textrm{d}(x, y)^2 \right\}</script>

<p><code class="highlighter-rouge">\(\sigma\)</code> is known as the length scale, large values of sigma indicate that large
changes in distance are required for the covariance to change significantly.
<code class="highlighter-rouge">\(h\)</code> controls the amount of change between two points. In addition some white
noise (Normally distributed with mean zero) representing independent measurement
noise can be added to the covariance function. Then the covariance function can be applied to the distance matrix using a <code class="highlighter-rouge">map</code>:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">covFn</span> <span class="k">=</span> <span class="o">(</span><span class="n">distance</span><span class="k">:</span> <span class="kt">Double</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nc">KernelFunction</span><span class="o">.</span><span class="n">squaredExponential</span><span class="o">(</span><span class="n">h</span> <span class="k">=</span> <span class="mf">3.0</span><span class="o">,</span>
     <span class="o">|</span> <span class="n">sigma</span> <span class="k">=</span> <span class="mf">5.0</span><span class="o">)(</span><span class="n">distance</span><span class="o">)</span> <span class="o">+</span> <span class="nc">KernelFunction</span><span class="o">.</span><span class="n">white</span><span class="o">(</span><span class="n">sigma</span> <span class="k">=</span> <span class="mf">0.5</span><span class="o">)(</span><span class="n">distance</span><span class="o">)</span>
<span class="n">covFn</span><span class="k">:</span> <span class="kt">Double</span> <span class="o">=&gt;</span> <span class="nc">Double</span> <span class="k">=</span> <span class="nc">$$Lambda$4405</span><span class="o">/</span><span class="mi">1175160170</span><span class="k">@</span><span class="mi">3</span><span class="n">e9d0ba0</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">covMat</span> <span class="k">=</span> <span class="n">m</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">covFn</span><span class="o">)</span>
<span class="n">covMat</span><span class="k">:</span> <span class="kt">breeze.linalg.DenseMatrix</span><span class="o">[</span><span class="kt">Double</span><span class="o">]</span> <span class="k">=</span>
<span class="mf">3.5</span>                    <span class="mf">2.999912106946619</span>      <span class="o">...</span> <span class="o">(</span><span class="mi">100</span> <span class="n">total</span><span class="o">)</span>
<span class="mf">2.999912106946619</span>      <span class="mf">3.5</span>                    <span class="o">...</span>
<span class="mf">2.9990096273720694</span>     <span class="mf">2.9995117364359003</span>     <span class="o">...</span>
<span class="mf">2.9792299306558157</span>     <span class="mf">2.9818320082942282</span>     <span class="o">...</span>
<span class="mf">2.893371657316043</span>      <span class="mf">2.899251493478395</span>      <span class="o">...</span>
<span class="mf">2.826603481470843</span>      <span class="mf">2.833996633890227</span>      <span class="o">...</span>
<span class="mf">2.814547517848851</span>      <span class="mf">2.8221720812532487</span>     <span class="o">...</span>
<span class="mf">2.7805724528445404</span>     <span class="mf">2.788799033739133</span>      <span class="o">...</span>
<span class="mf">2.6255713385404995</span>     <span class="mf">2.635892587604198</span>      <span class="o">...</span>
<span class="mf">2.5446903353209436</span>     <span class="mf">2.5558164882011836</span>     <span class="o">...</span>
<span class="mf">2.4826886032255286</span>     <span class="mf">2.4943357570881437</span>     <span class="o">...</span>
<span class="mf">2.4568238745753272</span>     <span class="mf">2.4686669985480343</span>     <span class="o">...</span>
<span class="mf">2.265755500926901</span>      <span class="mf">2.2787214030820113</span>     <span class="o">...</span>
<span class="mf">2.1659011476835404</span>     <span class="mf">2.1792615558343345</span>     <span class="o">...</span>
<span class="mf">2.0980993568059008</span>     <span class="mf">2.1116635135745234</span><span class="o">...</span>
</code></pre></div></div>

<p>Then a draw from a zero-mean Gaussian Process prior with covariance matrix
<code class="highlighter-rouge">covMat</code> at locations <code class="highlighter-rouge">xs</code> can be performed:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">breeze.linalg._</span>
<span class="k">import</span> <span class="nn">breeze.stats.distributions._</span>
<span class="k">val</span> <span class="n">nugget</span> <span class="k">=</span> <span class="n">diag</span><span class="o">(</span><span class="nc">DenseVector</span><span class="o">.</span><span class="n">fill</span><span class="o">(</span><span class="n">xs</span><span class="o">.</span><span class="n">size</span><span class="o">)(</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">3</span><span class="o">))</span>
<span class="k">val</span> <span class="n">root</span> <span class="k">=</span> <span class="n">eigSym</span><span class="o">(</span><span class="n">covMat</span> <span class="o">+</span> <span class="n">nugget</span><span class="o">)</span>
<span class="k">val</span> <span class="n">x</span> <span class="k">=</span> <span class="nc">DenseVector</span><span class="o">.</span><span class="n">rand</span><span class="o">(</span><span class="n">covMat</span><span class="o">.</span><span class="n">cols</span><span class="o">,</span> <span class="nc">Gaussian</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">))</span>
<span class="k">val</span> <span class="n">ys</span> <span class="k">=</span> <span class="n">root</span><span class="o">.</span><span class="n">eigenvectors</span> <span class="o">*</span> <span class="n">diag</span><span class="o">(</span><span class="n">root</span><span class="o">.</span><span class="n">eigenvalues</span><span class="o">.</span><span class="n">mapValues</span><span class="o">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="o">))</span> <span class="o">*</span> <span class="n">x</span>
</code></pre></div></div>

<p>Then the data can be plotted and saved:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">com.cibo.evilplot.plot.aesthetics.DefaultTheme._</span>

<span class="k">val</span> <span class="n">sims</span> <span class="k">=</span> <span class="nc">GaussianProcess</span><span class="o">.</span><span class="n">vecToData</span><span class="o">(</span><span class="n">ys</span><span class="o">,</span> <span class="n">xs</span><span class="o">)</span>
<span class="nc">Plot</span><span class="o">.</span><span class="n">scatterPlot</span><span class="o">(</span><span class="n">sims</span><span class="o">).</span>
  <span class="n">standard</span><span class="o">().</span>
  <span class="n">render</span><span class="o">().</span>
  <span class="n">write</span><span class="o">(</span><span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="nc">File</span><span class="o">(</span><span class="s">"docs/src/main/resources/figures/simulated_gp.png"</span><span class="o">))</span>
</code></pre></div></div>

<p><img src="../img/simulated_gp.png" alt="Simulated Gaussian Process" width="600" /></p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/gaussian-processes/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlighting();
              </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>((window.gitter = {}).chat = {}).options = {
room: 'jonnylaw/gaussian-processes'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/gaussian-processes/js/main.js"></script></body></html>